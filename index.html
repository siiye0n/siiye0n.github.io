<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ì•±</title>
<style id="__s"></style>
</head>
<body>
<script>

(function(){
  
  function el(t, attrs, txt){
    var e = document.createElement(t);
    if(attrs){
      for(var k in attrs){
        if(k === 'style') e.style.cssText = attrs[k];
        else if(k === 'class') e.className = attrs[k];
        else e.setAttribute(k, attrs[k]);
      }
    }
    if(typeof txt !== 'undefined') e.textContent = txt;
    return e;
  }

  // 
  var css = [
"body{font-family:Segoe UI,Pretendard,sans-serif;background:linear-gradient(135deg,#1a1b26,#232946);color:#e6eef8;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:48px;font-size:2rem;user-select:none}",
"h1{font-size:3.8rem;font-weight:700;color:#ffaad4;margin-bottom:2.4rem;text-shadow:0 0 16px rgba(255,170,212,0.35)}",
".container{background:rgba(255,255,255,0.04);border-radius:32px;padding:56px;box-shadow:0 12px 40px rgba(0,0,0,0.4);width:100%;max-width:1280px;text-align:center}",
".input-wrap{display:flex;gap:20px;align-items:center;justify-content:center;margin-bottom:28px}",
".form-control{flex:1;background:transparent;border-radius:20px;color:#e6eef8;border:3px solid rgba(255,122,182,0.35);padding:24px 28px;transition:all .2s;font-size:2rem;user-select:text}",
".form-control:focus{border-color:#ffaad4;box-shadow:0 0 12px rgba(255,170,212,0.32);outline:none}",
"button{background:linear-gradient(90deg,#ff7ab6,#ffaad4);border:none;border-radius:16px;padding:20px 28px;color:#fff;font-weight:600;cursor:pointer;transition:transform .15s;font-size:2rem}",
"button:disabled{opacity:.6;cursor:default;transform:none}",
"#status{margin-top:16px;font-size:1.9rem;color:#9eb7e5}",
"#result-box{margin-top:28px;padding:24px 28px;background:rgba(255,255,255,0.03);border-radius:20px;display:flex;gap:20px;align-items:center;justify-content:space-between;border:2px solid rgba(255,255,255,0.02);font-size:2rem;word-break:break-word;user-select:text}",
"#result-link{color:#ffd7ef;text-decoration:none;flex:1;user-select:text;display:none}",
"#result-placeholder{color:#93a6cc;flex:1}",
"#manualCopyBtn{display:none;padding:16px 24px;font-size:1.8rem;border-radius:12px;background:#ff7ab6;color:#fff;border:none;cursor:pointer}",
".spinner{display:inline-block;width:32px;height:32px;border:4px solid rgba(255,255,255,0.12);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite;vertical-align:middle;margin-right:16px}",
"@keyframes spin{to{transform:rotate(360deg)}}",
"#toast{position:fixed;bottom:40px;left:50%;transform:translateX(-50%);background:rgba(34,197,94,0.95);color:#fff;padding:16px 32px;font-size:2rem;border-radius:16px;opacity:0;pointer-events:none;transition:opacity .4s ease,transform .4s ease;z-index:9999}",
"#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}",
"@media(max-width:768px){body{font-size:1.6rem;padding:24px}h1{font-size:2.8rem}.input-wrap{flex-direction:column;gap:16px}.input-wrap button{width:100%;padding:16px;font-size:1.8rem}.form-control{padding:16px 20px;font-size:1.6rem}#result-box{flex-direction:column;align-items:stretch;gap:16px;font-size:1.6rem}#manualCopyBtn{width:100%}#toast{bottom:20px;padding:12px 20px;font-size:1.6rem;border-radius:12px}}"
  ].join("");

  document.getElementById('__s').textContent = css;

  
  var root = el('div',{class:'container', id:'__app'});
  root.appendChild(el('h1',null,'í•˜ì´ë¼ì´íŠ¸ ëŒ“ê¸€'));

  var iw = el('div',{class:'input-wrap'});
  var urlInput = el('input',{id:'urlInput',class:'form-control',placeholder:'ê²Œì‹œê¸€ URLì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: .../post/12345)'});
  var fetchBtn = el('button',{id:'fetchBtn',type:'button'},'ğŸ” ì°¾ê¸°');
  iw.appendChild(urlInput);
  iw.appendChild(fetchBtn);
  root.appendChild(iw);

  var status = el('div',{id:'status', role:'status','aria-live':'polite'},'READY');
  root.appendChild(status);

  var rb = el('div',{id:'result-box'});
  var rp = el('div',{id:'result-placeholder'},'ë§í¬ê°€ ì—¬ê¸° ìƒì„±ë©ë‹ˆë‹¤.');
  var rl = el('a',{id:'result-link',href:'#',target:'_blank',rel:'noopener'},'');
  var cp = el('button',{id:'manualCopyBtn',type:'button'},'ë³µì‚¬');
  rb.appendChild(rp); rb.appendChild(rl); rb.appendChild(cp);
  root.appendChild(rb);

  var toast = el('div',{id:'toast'},'ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
  document.body.appendChild(root);
  document.body.appendChild(toast);

  
  (function(){
    var _t = [
      "ì• êµìš©","https://chapi.sooplive.co.kr/api/","/title/","/comment",
      "textContent","href","display","none","inline-block","disabled","innerHTML",
      "navigator","clipboard","writeText","value","trim","toLowerCase","normalize",
      "NFKC","match","post","/post/","#comment_noti","#urlInput","#fetchBtn","#status",
      "#result-link","#result-placeholder","#manualCopyBtn","#toast",
      "Accept","application/json","GET","catch","then","JSON","Error","HTTP",
      "ê²€ìƒ‰ì¤‘...","ğŸ” ì°¾ê¸°","í•˜ì´ë¼ì´íŠ¸ ë§í¬ ìë™ ë³µì‚¬ë¨ ğŸ€",
      "ìë™ ë³µì‚¬ ì‹¤íŒ¨ â€” ìˆ˜ë™ ë²„íŠ¼ ì‚¬ìš©","ì‹¤íŒ¨: ","ë§í¬ ë³µì‚¬ ì™„ë£Œ ğŸ€"
    ];

    function _s(i){ return _t[i]; }

    function _n(s){
      if(!s) return "";
      try{
        return (s[_s(17)] && s[_s(16)]) ? s[_s(17)](_s(18)).toLowerCase().trim() : String(s).toLowerCase().trim();
      }catch(e){ return String(s).toLowerCase().trim(); }
    }

    function _p(u){
      try{
        var m = u[_s(19)](/\/station\/([^/]+)\/post\/(\d+)/);
        if(m) return {sid:m[1],tn:m[2]};
        var m2 = u[_s(19)](/\/([^/]+)\/post\/(\d+)/);
        if(m2) return {sid:m2[1],tn:m2[2]};
        var m3 = u[_s(19)](/\/post\/(\d+)/);
        if(m3) return {sid:'',tn:m3[1]};
      }catch(e){}
      return {sid:null,tn:null};
    }

    async function _f(sid,tn){
      var base = sid ? (_s(1) + sid + _s(2) + tn + _s(3)) : (_s(1) + "title/" + tn + _s(3));
      var firstUrl = base;
      var res = await fetch(firstUrl, { headers: { [_s(30)]: _s(31) } }).then(r=>{ if(!r.ok) throw new Error(_s(37)+r.status); return r.json(); });
      var last = Math.min((res.meta && res.meta.last_page) ? res.meta.last_page : 1, 50);
      var out = [];
      var concurrency = 5;
      for(var i=1;i<=last;i+=concurrency){
        var chunk = [];
        for(var j=i;j<Math.min(i+concurrency, last+1);j++){
          (function(pg){
            chunk.push(fetch(base + "?page=" + pg, { headers: { [_s(30)]: _s(31) } })
              .then(r=> r.ok ? r.json() : null)
              .catch(()=>null));
          })(j);
        }
        var arr = await Promise.all(chunk);
        for(var k=0;k<arr.length;k++){
          var raw = arr[k];
          var list = (raw && (raw.data || raw.comments)) ? (raw.data || raw.comments) : [];
          for(var c=0;c<list.length;c++){
            var it = list[c];
            out.push({
              user_nick: it.user_nick || it.user_name || it.nick || it.nickname || '',
              comment_no: it.p_comment_no || it.c_comment_no || it.comment_no || ''
            });
          }
        }
      }
      return out;
    }

    function _makePostUrl(sid,tn,commentNo){
      var h = commentNo ? (_s(21) + commentNo) : "";
      return "https://www.sooplive.co.kr/" + (sid ? sid + "/" : "") + _s(20) + tn + h;
    }

    async function _pick(url, targetNick){
      var ids = _p(url);
      var items = await _f(ids.sid, ids.tn);
      var tN = _n(targetNick || _s(0));
      for(var i=0;i<items.length;i++){
        if(_n(items[i].user_nick) === tN){
          return _makePostUrl(ids.sid, ids.tn, items[i].comment_no);
        }
      }
      return _makePostUrl(ids.sid, ids.tn, null);
    }

    var a = document.querySelector(_s(23));
    var b = document.querySelector(_s(24));
    var st = document.querySelector(_s(25));
    var resLink = document.querySelector(_s(26));
    var resPlaceholder = document.querySelector(_s(27));
    var copyBtn = document.querySelector(_s(28));
    var toast = document.querySelector(_s(29));

    function setStatus(txt,color){
      if(st){ st[_s(4)] = txt; if(color) st.style.color = color; }
    }
    function showToast(){
      if(toast){ toast.classList.add('show'); setTimeout(function(){ toast.classList.remove('show'); },3000); }
    }

    function setLoading(on){
      if(b){
        b[_s(9)] = !!on;
        b[_s(10)] = on ? ('<span class="spinner"></span>'+_s(38)) : _s(39);
        b.setAttribute('aria-busy', on ? 'true' : 'false');
      }
    }

    async function doWork(){
      var url = a ? (a[_s(14)] || '').trim() : '';
      resPlaceholder.style.display = '';
      resLink.style.display = 'none';
      copyBtn.style.display = 'none';
      if(!url){ setStatus('URLì„ ì…ë ¥í•˜ì„¸ìš”.', '#ef4444'); return; }
      setLoading(true);
      try{
        var link = await _pick(url, null);
        resPlaceholder.style.display = 'none';
        resLink.style.display = '';
        resLink[_s(4)] = link;
        resLink[_s(5)] = link;
        try{
          if(window[_s(11)] && window[_s(11)][_s(12)]){
            await window[_s(11)][_s(12)][_s(13)](link);
            setStatus(_s(40), '#22c55e');
            showToast();
          } else {
            throw new Error('no_clip');
          }
        }catch(e){
          setStatus(_s(41),'#facc15');
          copyBtn.style.display = 'inline-block';
        }
      }catch(e){
        setStatus(_s(42) + (e && e.message ? e.message : ''),'#ef4444');
        console.error(e);
      }finally{
        setLoading(false);
      }
    }

    if(b) b.addEventListener('click', function(){ doWork(); });
    if(a) a.addEventListener('keydown', function(e){ if(e.key === 'Enter') doWork(); });

    copyBtn.addEventListener('click', async function(){
      try{
        await navigator.clipboard.writeText(resLink.href);
        showToast();
        setStatus(_s(43), '#22c55e');
        copyBtn.style.display = 'none';
      }catch(e){
        alert('ë³µì‚¬ ì‹¤íŒ¨, ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”: ' + resLink.href);
      }
    });
  })();

})();
</script>
</body>
</html>
